//Generador de cliente, base de datos, roles y los esquemas de como est√°n planteadas las tablas
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER 
  CLIENT
}

model User {
  id Int @id @default(autoincrement())
  firstName String?
  lastName String?
  email String? @unique
  hashedPassword String?
  role Role @default(USER)
}

model Customer {
  id Int @id @default(autoincrement())
  firstName String?
  lastName String?
  email String? @unique
  hashedPassword String?
  orders Order[]
  reviews Review[]
  role Role @default(CLIENT)
}

model Book {
  id Int @id @default(autoincrement())
  title String
  author Author[]
  description String
  categories Category[]
  publisher String?
  publication Int?
  price Float
  quantity Int?
  selled Int?
  images Image[]
  reviews Review[] 
}

model Review {
  id Int @id @default(autoincrement())
  customer Customer @relation(fields: [customerId], references: [id])
  customerId Int @unique
  books Book @relation(fields: [bookId], references: [id])
  bookId Int @unique
  rating Int
  comment String
  createDate DateTime @default(now())
}

model Category {
  id Int @id @default(autoincrement())
  name String
  books Book[]
}

model Order{
  id Int @id @default(autoincrement())
  customer Customer @relation(fields: [customerId], references: [id])
  customerId Int @unique
  amount Float
  currency String
  status String
  deliveryStatus String?
  createDate DateTime @default(now())
  paymentIntentId String @unique
  products CartProductType[]
  address Address?
}

model CartProductType {
  id Int @id @default(autoincrement())
  name String
  description String
  category String
  brand String
  selectedImg String
  quantity Int
  price Float
  orders Order[]
}

model Image {
  id Int @id @default(autoincrement())
  image String
  books Book @relation(fields: [bookId], references: [id])
  bookId Int
}

model Address {
  id Int @id @default(autoincrement())
  city String
  country String
  line1 String
  line2 String?
  postal_code String
  state String
  orders Order @relation(fields: [orderId], references: [id])
  orderId Int @unique
}

model Author {
  id Int @id @default(autoincrement())
  firstName String
  lastName String
  books Book[]
}
